(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,l)=>{t.exports=e.r(76562)},41394,e=>{"use strict";var t=e.i(43476),l=e.i(71645),r=e.i(18566),s=e.i(63371),o=e.i(11795);function n(){let e=(0,r.useRouter)(),{user:n,updateUserPhotos:a}=(0,s.useApp)(),[i,u]=(0,l.useState)([null,null,null]),[c,d]=(0,l.useState)([null,null,null]),[h,m]=(0,l.useState)(!1),[p,x]=(0,l.useState)(null),f=(0,l.useRef)([]);(0,l.useEffect)(()=>{n||e.replace("/signup")},[n,e]);let b=async()=>{if(0===i.filter(e=>null!==e).length)return void x("Please select at least one photo");if(!n)return void x("You must be signed in");m(!0),x(null);let t=(0,o.createClient)();if(!t){x("Supabase is not configured"),m(!1);return}try{let l=[];for(let e=0;e<i.length;e++){let r=i[e];if(!r)continue;let s=r.name.split(".").pop()??"jpg",o=`${n.id}/${e}-${Date.now()}.${s}`,{error:a}=await t.storage.from("profile-photos").upload(o,r,{cacheControl:"3600",upsert:!0});if(a){x(`Upload failed: ${a.message}`),m(!1);return}let{data:u}=t.storage.from("profile-photos").getPublicUrl(o);l.push(u.publicUrl)}let{error:r}=await a(l);if(r){x(r.message),m(!1);return}e.push("/matches")}catch{x("Something went wrong. Please try again."),m(!1)}};if(!n)return null;let g=i.filter(e=>null!==e).length;return(0,t.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,t.jsx)("header",{className:"py-6 px-4",children:(0,t.jsx)("button",{type:"button",onClick:()=>e.push("/matches"),className:"text-[#A89888] hover:text-[#F5F0E8] text-sm",children:"Skip for now →"})}),(0,t.jsxs)("main",{className:"flex-1 max-w-md mx-auto w-full px-4 py-8",children:[(0,t.jsx)("h1",{className:"text-2xl font-medium text-[#F5F0E8] [font-family:var(--font-cormorant)] mb-2",children:"Add your photos"}),(0,t.jsxs)("p",{className:"text-[#D4C9BC] text-sm mb-8",children:["Upload up to ",3," photos. These will be blurred until your matches get to know you."]}),p&&(0,t.jsx)("p",{className:"text-sm text-[#940128] bg-[#940128]/10 rounded-xl px-4 py-2 mb-6",children:p}),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-4 mb-8",children:Array.from({length:3}).map((e,l)=>(0,t.jsxs)("div",{className:"relative aspect-[3/4]",children:[c[l]?(0,t.jsxs)("div",{className:"relative w-full h-full rounded-2xl overflow-hidden border-2 border-[#800022]",children:[(0,t.jsx)("img",{src:c[l],alt:`Photo ${l+1}`,className:"w-full h-full object-cover"}),(0,t.jsx)("button",{type:"button",onClick:()=>{let e,t;return e=[...i],t=[...c],void(e[l]=null,t[l]=null,u(e),d(t),f.current[l]&&(f.current[l].value=""))},className:"absolute top-2 right-2 w-7 h-7 rounded-full bg-[#3F1414]/80 text-[#F5F0E8] flex items-center justify-center text-sm hover:bg-[#940128] transition-colors",children:"×"})]}):(0,t.jsxs)("button",{type:"button",onClick:()=>f.current[l]?.click(),className:"w-full h-full rounded-2xl border-2 border-dashed border-[#800022]/40 bg-[#550015]/30 flex flex-col items-center justify-center text-[#A89888] hover:border-[#800022] hover:text-[#D4C9BC] transition-colors cursor-pointer",children:[(0,t.jsx)("svg",{className:"w-8 h-8 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),(0,t.jsxs)("span",{className:"text-xs",children:["Photo ",l+1]})]}),(0,t.jsx)("input",{ref:e=>{f.current[l]=e},type:"file",accept:"image/*",className:"hidden",onChange:e=>((e,t)=>{if(!t)return;if(!t.type.startsWith("image/"))return void x("Please select an image file");if(t.size>5242880)return void x("Image must be under 5MB");x(null);let l=[...i];l[e]=t,u(l);let r=new FileReader;r.onload=t=>{let l=[...c];l[e]=t.target?.result,d(l)},r.readAsDataURL(t)})(l,e.target.files?.[0]??null)})]},l))}),(0,t.jsxs)("p",{className:"text-center text-xs text-[#A89888] mb-6",children:[g," of ",3," photos selected · Max 5MB each"]}),(0,t.jsx)("button",{type:"button",onClick:b,disabled:h||0===g,className:"w-full rounded-xl bg-[#940128] text-[#F5F0E8] py-3.5 font-medium hover:bg-[#800022] transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:h?"Uploading…":"Upload & continue"})]})]})}e.s(["default",()=>n])}]);